---
import { Image } from 'astro:assets';
import imgCasaLujan from '../../public/casalujancuyo.png';
import imgNuevaCasa from '../../public/nueva-casa.jpg';
---

<section id="alojamiento" class="py-20 bg-gradient-to-br from-[#fff6eb] to-[#ffe4c4]">
  <div class="container">
    <h2 class="text-center text-brand-orange mb-16">Alojamiento Destacado</h2>
    
    <div class="relative">
      <!-- Botón Anterior -->
      <button 
        id="prev-btn" 
        class="absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-brand-orange text-white p-3 rounded-full shadow-lg hover:bg-brand-orange/90 transition-all md:-left-4"
        aria-label="Alojamiento anterior"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </button>

      <!-- Contenedor del carrusel -->
      <div class="overflow-hidden">
        <div id="carousel-track" class="flex transition-transform duration-500 ease-in-out">
          
          <!-- Casa 1: Luján de Cuyo -->
          <div class="w-full flex-shrink-0">
            <div class="grid md:grid-cols-2 gap-8 bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-xl border border-white/50">
              <div class="rounded-xl aspect-square overflow-hidden">
                <Image 
                  src={imgCasaLujan} 
                  alt="Casa de estilo colonial con jardín en Luján de Cuyo, Mendoza" 
                  class="w-full h-full object-cover"
                  widths={[400, 800]}
                  sizes="(max-width: 768px) 100vw, 50vw"
                  loading="lazy"
                />
              </div>
              <div class="flex flex-col justify-center">
                <h3 class="text-brand-orange mb-4 text-2xl">Casa Luján de Cuyo</h3>
                <p class="text-gray-600 mb-6">En Mayor Drummond, barrio tranquilo. Perfecta para grupos de hasta 7 personas.</p>
                <ul class="space-y-2 text-sm text-gray-600 mb-8">
                  <li>✓ 3 habitaciones (2 dobles, 3 simples) y 2 baños</li>
                  <li>✓ Cocina equipada y living comedor amplio</li>
                  <li>✓ Jardín con pileta y quincho con churrasquera</li>
                  <li>✓ Wi-Fi, estacionamiento y vigilancia 24hs</li>
                </ul>
                <a href="#contacto" class="btn btn-primary bg-brand-orange text-white hover:bg-brand-orange/90 w-fit">Ver más alojamientos</a>
              </div>
            </div>
          </div>

          <!-- Casa 2: Arístides Lodge -->
          <div class="w-full flex-shrink-0">
            <div class="grid md:grid-cols-2 gap-8 bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-xl border border-white/50">
              <div class="rounded-xl aspect-square overflow-hidden">
                <Image 
                  src={imgNuevaCasa} 
                  alt="Arístides Lodge en Aristides Villanueva, Mendoza" 
                  class="w-full h-full object-cover"
                  widths={[400, 800]}
                  sizes="(max-width: 768px) 100vw, 50vw"
                  loading="lazy"
                />
              </div>
              <div class="flex flex-col justify-center">
                <h3 class="text-brand-orange mb-4 text-2xl">Arístides Lodge</h3>
                <p class="text-gray-600 mb-6">En Aristides Villanueva 185, a 5 minutos de Plaza Independencia. Amplia casa de 280 m² ideal para familias.</p>
                <ul class="space-y-2 text-sm text-gray-600 mb-8">
                  <li>✓ 4 dormitorios y 4 baños completos</li>
                  <li>✓ Cocina totalmente equipada (nevera, horno, microondas)</li>
                  <li>✓ TV con canales por satélite y aire acondicionado</li>
                  <li>✓ Wi-Fi gratis, aparcamiento y se permiten mascotas</li>
                </ul>
                <a href="#contacto" class="btn btn-primary bg-brand-orange text-white hover:bg-brand-orange/90 w-fit">Ver más alojamientos</a>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- Botón Siguiente -->
      <button 
        id="next-btn" 
        class="absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-brand-orange text-white p-3 rounded-full shadow-lg hover:bg-brand-orange/90 transition-all md:-right-4"
        aria-label="Siguiente alojamiento"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>

      <!-- Indicadores -->
      <div class="flex justify-center gap-2 mt-6">
        <button class="carousel-indicator w-3 h-3 rounded-full bg-brand-orange transition-all" data-index="0"></button>
        <button class="carousel-indicator w-3 h-3 rounded-full bg-gray-300 transition-all" data-index="1"></button>
      </div>
    </div>
  </div>
</section>

<script>
  let currentIndex = 0;
  const track = document.getElementById('carousel-track');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  const indicators = document.querySelectorAll('.carousel-indicator');
  const totalSlides = 2;
  let autoPlayInterval: number;

  function updateCarousel() {
    if (track) {
      track.style.transform = `translateX(-${currentIndex * 100}%)`;
    }
    
    // Actualizar indicadores
    indicators.forEach((indicator, index) => {
      if (index === currentIndex) {
        indicator.classList.remove('bg-gray-300');
        indicator.classList.add('bg-brand-orange');
      } else {
        indicator.classList.remove('bg-brand-orange');
        indicator.classList.add('bg-gray-300');
      }
    });
  }

  function nextSlide() {
    currentIndex = currentIndex === totalSlides - 1 ? 0 : currentIndex + 1;
    updateCarousel();
  }

  function resetAutoPlay() {
    clearInterval(autoPlayInterval);
    startAutoPlay();
  }

  function startAutoPlay() {
    autoPlayInterval = setInterval(() => {
      nextSlide();
    }, 5000); // Cambia cada 5 segundos
  }

  prevBtn?.addEventListener('click', () => {
    currentIndex = currentIndex === 0 ? totalSlides - 1 : currentIndex - 1;
    updateCarousel();
    resetAutoPlay(); // Reinicia el auto-play al hacer clic
  });

  nextBtn?.addEventListener('click', () => {
    nextSlide();
    resetAutoPlay(); // Reinicia el auto-play al hacer clic
  });

  indicators.forEach((indicator) => {
    indicator.addEventListener('click', () => {
      const index = parseInt(indicator.getAttribute('data-index') || '0');
      currentIndex = index;
      updateCarousel();
      resetAutoPlay(); // Reinicia el auto-play al hacer clic
    });
  });

  // Iniciar auto-play cuando carga la página
  startAutoPlay();

  // Pausar auto-play cuando el mouse está sobre el carrusel
  const carouselSection = document.getElementById('alojamiento');
  carouselSection?.addEventListener('mouseenter', () => {
    clearInterval(autoPlayInterval);
  });

  carouselSection?.addEventListener('mouseleave', () => {
    startAutoPlay();
  });
</script>